# Signet Protocol Specification (v0.2.6)
**Draft-Song-Signet-Neural-Lens-02.6**

## 1. Introduction
This document defines the Signet Protocol, a standard for attaching cryptographic proof of reasoning (VPR) to AI-generated content, aligned with **C2PA 2.3**.

## 2. Global Identity Registry (TrustKey Service)
To ensure the accountability of the 8 billion human curators, the protocol mandates a centralized settlement layer for Identity-to-Key binding.

### 2.1 Identity Uniqueness & Storage
- **System Anchor**: All identities MUST be indexed by a 32-byte deterministic UUID derived from the full hierarchical identity string.
- **Uniqueness**: The Registry MUST enforce a "First-to-Claim" policy. Registration attempts for existing anchor IDs MUST be rejected at the database security layer.
- **Sub-Namespacing**: Companies and organizations MAY create sub-namespaces (e.g., `user:org:signetai.io`) which are hashed into unique system anchors.

### 2.2 Public Key Lookup
- All Signet nodes MUST provide a public lookup endpoint or direct database read access to the `identities` collection.
- Responses MUST return the associated 256-bit Public Key or a 404 error if unregistered.

## 3. Cryptographic Requirements
- **Algorithm**: MUST use Ed25519 for all signatures.
- **Hashing**: SHA-256 MUST be used for generating system anchors and content hashes.
- **Key Storage**: Keys generated by the TrustKeyService SHOULD be stored in Hardware Security Modules (HSM) or TEEs.

## 4. The X-Signet-VPR Header
All Signet-compliant API responses MUST include the `X-Signet-VPR` header. This header contains a base64-encoded JSON object representing the signature chain.

### 4.1 Payload Structure
```json
{
  "protocol_version": "0.2.6",
  "timestamp": 1740000000,
  "chain": [
    {
      "entity": "MODEL",
      "id": "gemini-3-pro-preview",
      "signature": "..."
    },
    {
      "entity": "TOOL",
      "id": "neural-code-v2",
      "signature": "..."
    },
    {
      "entity": "HUMAN",
      "id": "master-curator-01",
      "signature": "..."
    }
  ],
  "parity_score": 0.998
}
```